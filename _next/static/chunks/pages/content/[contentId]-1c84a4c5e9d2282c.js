(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[450],{6606:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/content/[contentId]",function(){return t(5956)}])},5956:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return w}});var s=t(5666),r=t.n(s),a=t(5893),c=t(1163),i=t(4467),o=t(5321),l=t(7294),d=t(4603),u=t(1664),h=t(1132),p=t(7092);function x(e){var n=e.reviews;return(0,a.jsx)(a.Fragment,{children:n&&n.length>0?(0,a.jsxs)("span",{children:[(0,a.jsxs)("span",{className:"text-accent-hc font-bold px-2 text-base",children:[+parseFloat(n.reduce((function(e,n){return e+n.data.rating}),0)/n.length).toFixed(2),(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 inline-block",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})]}),(0,a.jsxs)("span",{className:"text-sm",children:["(",n.length," reviews)"]})]}):(0,a.jsx)("span",{className:"text-xs",children:"No reviews yet"})})}var m=t(6688);function f(e,n,t,s,r,a,c){try{var i=e[a](c),o=i.value}catch(l){return void t(l)}i.done?n(o):Promise.resolve(o).then(s,r)}function v(e){return function(){var n=this,t=arguments;return new Promise((function(s,r){var a=e.apply(n,t);function c(e){f(a,s,r,c,i,"next",e)}function i(e){f(a,s,r,c,i,"throw",e)}c(void 0)}))}}function w(){var e=(0,m.h)(),n=e.user,t=e.userInDb,s=(0,l.useState)({}),f=s[0],w=s[1],j=(0,l.useState)({}),b=j[0],g=j[1],y=(0,l.useState)([]),k=y[0],N=y[1],J=(0,l.useState)([]),C=J[0],U=J[1],O=(0,l.useState)(null),S=O[0],E=O[1],L=(0,l.useState)(null),I=L[0],D=L[1],P=(0,l.useState)([]),_=P[0],R=P[1],M=(0,l.useState)(!1),V=M[0],T=M[1],A=(0,l.useState)(!1),z=A[0],B=A[1],F=(0,l.useState)([]),Z=F[0],q=F[1],W=(0,l.useState)(!1),K=W[0],Q=W[1],X=(0,l.useState)(!1),Y=X[0],H=X[1],G=(0,l.useRef)(),$=(0,l.useRef)(),ee=(0,l.useState)(!1),ne=ee[0],te=ee[1],se=(0,l.useState)({}),re=se[0],ae=se[1],ce=(0,l.useState)(0),ie=ce[0],oe=ce[1],le=(0,l.useRef)(),de=(0,l.useRef)(),ue=(0,o.ad)(i.Z),he=(0,c.useRouter)(),pe=he.query.contentId,xe=v(r().mark((function e(n){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),!(z&&Object.keys(t).length>0)){e.next=14;break}if(!ne){e.next=8;break}return e.next=5,(0,o.r7)((0,o.JU)(ue,"reviews",re.id),{rating:ie,description:le.current.value});case 5:e.sent,e.next=12;break;case 8:return s={content:(0,o.JU)(ue,"content",pe),user:(0,o.JU)(ue,"users",t.id),rating:ie,description:le.current.value},e.next=11,(0,o.ET)((0,o.hJ)(ue,"reviews"),s);case 11:e.sent;case 12:Je(),Ne();case 14:case"end":return e.stop()}}),e)}))),me=v(r().mark((function e(n){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t=(0,o.JU)(ue,"content",pe),e.next=4,(0,o.r7)(t,{name:G.current.value});case 4:Q(!1),Oe();case 6:case"end":return e.stop()}}),e)}))),fe=v(r().mark((function e(n){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t=(0,o.JU)(ue,"content",pe),e.next=4,(0,o.r7)(t,{description:$.current.value});case 4:H(!1),Oe();case 6:case"end":return e.stop()}}),e)}))),ve=v(r().mark((function e(n){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!V){e.next=5;break}return t=(0,o.JU)(ue,"content",pe),e.next=4,(0,o.r7)(t,{public:!0,price:0});case 4:Oe();case 5:case"end":return e.stop()}}),e)}))),we=v(r().mark((function e(n){var s,a,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),s=de.current.value,(a=f).name=s,a.originalName=f.name,a.copyOf=(0,o.JU)(ue,"content",pe),a.copyDate=o.EK.now(),a.public=!1,a.trusted=!1,a.owner=(0,o.JU)(ue,"users",t.id),e.next=12,(0,o.ET)((0,o.hJ)(ue,"content"),a);case 12:c=e.sent,he.push("/content/".concat(c.id));case 14:case"end":return e.stop()}}),e)}))),je=v(r().mark((function e(n){var s,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&Object.keys(t).length>0)){e.next=12;break}if(t.id!=n.owner.id){e.next=5;break}return T(!0),B(!1),e.abrupt("return",!0);case 5:return T(!1),s=(0,o.IO)((0,o.hJ)(ue,"sales"),(0,o.ar)("content","==",(0,o.JU)(ue,"content",pe)),(0,o.ar)("buyer","==",(0,o.JU)(ue,"users",t.id)),(0,o.b9)(1)),e.next=9,(0,o.PL)(s);case 9:return a=e.sent,B(a.docs.length>0),e.abrupt("return",a.docs.length>0);case 12:case"end":return e.stop()}}),e)}))),be=v(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(V||z){e.next=5;break}return e.next=3,(0,o.ET)((0,o.hJ)(ue,"sales"),{buyer:(0,o.JU)(ue,"users",t.id),content:(0,o.JU)(ue,"content",pe),datetime:o.EK.now()});case 3:e.sent,B(!0);case 5:case"end":return e.stop()}}),e)}))),ge=v(r().mark((function e(){var n,s,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.IO)((0,o.hJ)(ue,"content"),(0,o.ar)("copyOf","==",(0,o.JU)(ue,"content",pe)),(0,o.ar)("owner","==",(0,o.JU)(ue,"users",t.id))),e.next=3,(0,o.PL)(n);case 3:s=e.sent,a=s.docs.map((function(e){return{id:e.id,data:e.data()}})),q(a);case 6:case"end":return e.stop()}}),e)}))),ye=v(r().mark((function e(n){var t,s,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,o.JU)(ue,"users",n.owner.id),e.next=3,(0,o.QT)(t);case 3:s=e.sent,a=s.data(),g(a);case 6:case"end":return e.stop()}}),e)}))),ke=v(r().mark((function e(n){var t,s,a,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.tags.map((function(e){return e.id})),s=(0,o.IO)((0,o.hJ)(ue,"tags"),(0,o.ar)((0,o.Jm)(),"in",t)),e.next=4,(0,o.PL)(s);case 4:a=e.sent,c=a.docs.map((function(e){return{id:e.id,data:e.data()}})),R(c);case 7:case"end":return e.stop()}}),e)}))),Ne=v(r().mark((function e(){var n,t,s,a,c,i,l,d;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.JU)(ue,"content",pe),t=(0,o.IO)((0,o.hJ)(ue,"reviews"),(0,o.ar)("content","==",n)),e.next=4,(0,o.PL)(t);case 4:if(s=e.sent,a=s.docs.map((function(e){return{id:e.id,data:e.data()}})),!((c=a.map((function(e){return e.data.user.id}))).length>0)){e.next=17;break}return i=(0,o.IO)((0,o.hJ)(ue,"users"),(0,o.ar)((0,o.Jm)(),"in",c)),e.next=11,(0,o.PL)(i);case 11:l=e.sent,d=l.docs.map((function(e){return{id:e.id,data:e.data()}})),U(d),N(a),e.next=18;break;case 17:U([]),N([]);case 18:case"end":return e.stop()}}),e)}))),Je=v(r().mark((function e(){var n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&Object.keys(t).length>0&&z)){e.next=6;break}return n=(0,o.IO)((0,o.hJ)(ue,"reviews"),(0,o.ar)("content","==",(0,o.JU)(ue,"content",pe)),(0,o.ar)("user","==",(0,o.JU)(ue,"users",t.id))),e.next=4,(0,o.PL)(n);case 4:(s=e.sent).docs.length>0?(ae({id:s.docs[0].id,data:s.docs[0].data()}),te(!0)):(te(!1),ae({}));case 6:case"end":return e.stop()}}),e)}))),Ce=v(r().mark((function e(){var n,t,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.JU)(ue,"content",pe),t=(0,o.IO)((0,o.hJ)(ue,"sales"),(0,o.ar)("content","==",n)),e.next=4,(0,o.PL)(t);case 4:s=e.sent,D(s.docs.length);case 6:case"end":return e.stop()}}),e)}))),Ue=v(r().mark((function e(){var n,t,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.JU)(ue,"content",pe),t=(0,o.IO)((0,o.hJ)(ue,"content"),(0,o.ar)("copyOf","==",n)),e.next=4,(0,o.PL)(t);case 4:s=e.sent,E(s.docs.length);case 6:case"end":return e.stop()}}),e)}))),Oe=v(r().mark((function e(){var n,t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!pe){e.next=6;break}return n=(0,o.JU)(ue,"content",pe),e.next=4,(0,o.QT)(n);case 4:(t=e.sent).exists()?w(t.data()):he.push("/404","/not-found");case 6:case"end":return e.stop()}}),e)})));return(0,l.useEffect)((function(){Oe()}),[pe]),(0,l.useEffect)((function(){f&&0!=Object.keys(f).length&&(ye(f),ke(f),Ne(),Ce(),Ue())}),[f]),(0,l.useEffect)((function(){(n||q([]),f&&t&&0!=Object.keys(f).length&&0!=Object.keys(t).length)&&(je(f)&&ge());Je()}),[f,n,t]),(0,l.useEffect)((function(){Je()}),[t,z]),(0,l.useEffect)((function(){d.Z.getInstance().logEvent("Viewed Page: Content Details",{"Content ID":pe})}),[]),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-2xl",children:f.name}),n&&V&&(0,a.jsxs)("button",{className:"border border-gray-400 mx-2 p-2 hover:bg-gray-400 hover:text-white rounded",onClick:function(){Q(!0)},children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 inline-block",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})," ","Edit"]})]}),K&&(0,a.jsx)("div",{children:(0,a.jsxs)("form",{onSubmit:me,children:[(0,a.jsx)("label",{children:"New Name"}),(0,a.jsx)("input",{type:"text",ref:G,className:"input-base form-input",name:"updatedName",defaultValue:f.name}),(0,a.jsxs)("button",{className:"btn-primary",type:"submit",onClick:me,children:[" ","Update Name"]}),(0,a.jsx)("button",{onClick:function(){Q(!1)},children:"Cancel"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs",children:"Authored by"}),b?(0,a.jsxs)("div",{className:"text-gray-800",children:[(0,a.jsx)("span",{children:b.photoUrl?(0,a.jsx)("img",{src:b.photoUrl,className:"h-8 inline-block rounded-full"}):(0,a.jsx)("img",{src:"profile_pic.png",className:"h-8 inline-block rounded-full"})}),(0,a.jsx)("span",{className:"ml-1 text-base",children:b.name})]}):(0,a.jsx)("div",{})]}),(0,a.jsx)("div",{className:"my-2",children:!f.copyOf&&f.public&&k&&(0,a.jsx)(x,{reviews:k})}),(0,a.jsx)("div",{className:"my-2",children:_&&_.map((function(e){return(0,a.jsx)("span",{style:{background:e.data.color,color:e.data.textColor},className:"rounded-3xl px-2 mx-1 text-xs",children:e.data.name},e.id)}))})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-4 ",children:[(0,a.jsxs)("div",{children:[f.description,n&&V&&(0,a.jsxs)("button",{className:"border border-gray-400 mx-2 p-2 hover:bg-gray-400 hover:text-white rounded",onClick:function(){H(!0)},children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 inline-block",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})," ","Edit"]})]}),Y&&(0,a.jsx)("div",{children:(0,a.jsxs)("form",{onSubmit:fe,children:[(0,a.jsx)("label",{children:"New Description"}),(0,a.jsx)("textarea",{type:"text",ref:$,className:"input-base form-input",name:"updatedDescription",defaultValue:f.description}),(0,a.jsxs)("button",{className:"btn-primary",type:"submit",onClick:fe,children:[" ","Update Description"]}),(0,a.jsx)("button",{onClick:function(){H(!1)},children:"Cancel"})]})})]}),n&&V&&!f.copyOf&&!f.public&&(0,a.jsxs)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-4",children:[(0,a.jsx)("div",{className:"text-base",children:"Would you like to list this content publicly?"}),(0,a.jsxs)("div",{className:"text-sm",children:["Listing content will make it publicly available to others for free! Listing content publicly will allow others to copy it and use it on the Peerbots app."," "]}),(0,a.jsx)("div",{className:"text-sm font-bold",children:"Once content is public it can not be made private."}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{className:"btn-primary",onClick:ve,children:"List this publicly for free!"})})]}),n&&z&&(0,a.jsxs)("div",{className:"bg-white shadow-lg rounded p-4 my-4 mx-2",children:[ne?(0,a.jsx)("span",{children:"Update your review"}):(0,a.jsx)("span",{children:"Write a review"}),(0,a.jsxs)("form",{onSubmit:xe,children:[(0,a.jsxs)("div",{children:["New Rating:",(0,a.jsx)(p.Z,{max:5,onChange:function(e,n){oe(n)},className:"p-4"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Review:"}),ne?(0,a.jsx)("input",{type:"input",className:"input-base",ref:le,placeholder:"Review Details",defaultValue:re.data.description}):(0,a.jsx)("input",{type:"input",className:"input-base",ref:le,placeholder:"Review Details"}),(0,a.jsx)("button",{className:"btn-primary",type:"submit",children:"Submit Review"})]})]})]}),f.public&&!f.copyOf&&k.length>0&&(0,a.jsx)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-4 ",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-bold",children:"Reviews"}),k.map((function(e){return(0,a.jsxs)("div",{className:"bg-white shadow-lg rounded p-4 w-64",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsx)("div",{children:(0,a.jsx)(p.Z,{value:e.data.rating,max:5,readOnly:!0,size:"small"})}),(0,a.jsxs)("div",{className:"align-middle",children:[(0,a.jsx)("span",{children:(0,a.jsx)("img",{src:C.filter((function(n){return n.id==e.data.user.id}))[0].data.photoUrl,className:"rounded-full h-6 w-6 inline-block mr-1"})}),(0,a.jsx)("span",{className:"text-sm",children:C.filter((function(n){return n.id==e.data.user.id}))[0].data.name})]})]}),(0,a.jsx)("div",{className:"text-sm text-gray-700",children:e.data.description})]},e.id)}))]})}),f.public&&!f.copyOf&&(0,a.jsxs)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-4 ",children:[(0,a.jsx)("div",{children:!f.copyOf&&f.public&&k&&(0,a.jsx)(x,{reviews:k})}),(0,a.jsx)("div",{children:0==f.price?(0,a.jsx)("span",{className:"uppercase",children:"Free"}):(0,a.jsx)("span",{children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(f.price)})}),(0,a.jsx)("div",{children:I&&(0,a.jsxs)("span",{children:[" ",(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 inline-block",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),I," sales"," "]})}),(0,a.jsx)("div",{children:S&&(0,a.jsxs)("span",{children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 inline-block",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"})}),S," copies"]})}),n?(0,a.jsx)(a.Fragment,{children:!(V||z)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{className:"btn-primary",onClick:function(){d.Z.getInstance().logEvent("Clicked Button: Content Details - Acquire Content",{"Content ID":pe}),be()},children:"+ Acquire Content"})," "]})}):(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm",children:"You must sign in to acquire content."}),(0,a.jsx)("button",{className:"btn-primary",disabled:!0,children:"+ Acquire Content"})]})]}),f.copyOf&&(0,a.jsx)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-4",children:(0,a.jsxs)("span",{children:["This is a copy of"," ",(0,a.jsx)(u.default,{href:"/content/[contentId]",as:"/content/".concat(f.copyOf.id),children:"original content link"})]})}),n&&(V||z)&&(0,a.jsx)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-4",children:(0,a.jsxs)("form",{onSubmit:we,children:[(0,a.jsx)("label",{children:"Copy As"}),(0,a.jsx)("input",{type:"text",ref:de,className:"input-base form-input",name:"copyAs",defaultValue:"Copy of ".concat(f.name)}),(0,a.jsxs)("button",{className:"btn-primary",type:"submit",onClick:we,children:[" ","Copy to App!"]})]})}),(0,a.jsx)("div",{children:Z.length>0?(0,a.jsx)("div",{children:(0,a.jsx)(h.Z,{content:Z,children:(0,a.jsx)("h3",{children:"Your copies"})})}):(0,a.jsx)("div",{children:""})})]})}}},function(e){e.O(0,[92,132,774,888,179],(function(){return n=6606,e(e.s=n);var n}));var n=e.O();_N_E=n}]);