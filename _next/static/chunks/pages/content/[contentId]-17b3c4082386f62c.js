(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[450],{6606:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/content/[contentId]",function(){return n(5180)}])},5180:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var s=n(5666),r=n.n(s),a=n(5893),c=n(5321),i=n(7294),o=n(1132),l=n(1664),d=n(7092),u=n(2182),x=n(234),m=n(4603),p=n(4467),h=n(6688),f=n(1163);function v(e,t,n,s,r,a,c){try{var i=e[a](c),o=i.value}catch(l){return void n(l)}i.done?t(o):Promise.resolve(o).then(s,r)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(s,r){var a=e.apply(t,n);function c(e){v(a,s,r,c,i,"next",e)}function i(e){v(a,s,r,c,i,"throw",e)}c(void 0)}))}}function w(){var e=function(){if(fe.current){var e=fe.current.scrollHeight,t=fe.current.clientHeight;e>0&&t>0&&we(e>t)}},t=(0,h.h)(),n=t.user,s=t.userInDb,v=(0,i.useState)({}),w=v[0],j=v[1],g=(0,i.useState)({}),N=g[0],y=g[1],k=(0,i.useState)([]),J=k[0],C=k[1],O=(0,i.useState)([]),U=O[0],S=O[1],E=(0,i.useState)(null),L=E[0],I=E[1],D=(0,i.useState)(null),P=D[0],R=D[1],_=(0,i.useState)([]),T=_[0],V=_[1],M=(0,i.useState)({}),Z=M[0],z=M[1],A=(0,i.useState)(!1),q=A[0],B=A[1],F=(0,i.useState)(!1),H=F[0],Q=F[1],W=(0,i.useState)([]),K=W[0],X=W[1],Y=(0,i.useState)(!1),G=Y[0],$=Y[1],ee=(0,i.useState)(!1),te=ee[0],ne=ee[1],se=(0,i.useRef)(),re=(0,i.useRef)(),ae=(0,i.useState)(!1),ce=ae[0],ie=ae[1],oe=(0,i.useState)({}),le=oe[0],de=oe[1],ue=(0,i.useState)(0),xe=ue[0],me=ue[1],pe=(0,i.useRef)(),he=(0,i.useRef)(),fe=(0,i.useRef)(),ve=(0,i.useState)(!0),be=ve[0],we=ve[1],je=(0,i.useState)(!1),ge=je[0],Ne=je[1],ye=(0,c.ad)(p.Z),ke=(0,f.useRouter)(),Je=ke.query.contentId,Ce=b(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(H&&Object.keys(s).length>0)){e.next=14;break}if(!ce){e.next=8;break}return e.next=5,(0,c.r7)((0,c.JU)(ye,"reviews",le.id),{rating:xe,description:pe.current.value});case 5:e.sent,e.next=12;break;case 8:return n={content:(0,c.JU)(ye,"content",Je),user:(0,c.JU)(ye,"users",s.id),rating:xe,description:pe.current.value},e.next=11,(0,c.ET)((0,c.hJ)(ye,"reviews"),n);case 11:e.sent;case 12:Ve(),Te();case 14:case"end":return e.stop()}}),e)}))),Oe=b(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=(0,c.JU)(ye,"content",Je),e.next=4,(0,c.r7)(n,{name:se.current.value});case 4:$(!1),ze();case 6:case"end":return e.stop()}}),e)}))),Ue=b(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=(0,c.JU)(ye,"content",Je),e.next=4,(0,c.r7)(n,{description:re.current.value});case 4:ne(!1),ze();case 6:case"end":return e.stop()}}),e)}))),Se=b(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!q){e.next=5;break}return n=(0,c.JU)(ye,"content",Je),e.next=4,(0,c.r7)(n,{public:!0,price:0});case 4:ze();case 5:case"end":return e.stop()}}),e)}))),Ee=b(r().mark((function e(t){var n,a,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=he.current.value,(a=w).name=n,a.originalName=w.name,a.copyOf=(0,c.JU)(ye,"content",Je),a.copyDate=c.EK.now(),a.public=!1,a.trusted=!1,a.owner=(0,c.JU)(ye,"users",s.id),e.next=12,(0,c.ET)((0,c.hJ)(ye,"content"),a);case 12:i=e.sent,ke.push("/content/".concat(i.id));case 14:case"end":return e.stop()}}),e)}))),Le=b(r().mark((function e(t){var n,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s&&Object.keys(s).length>0)){e.next=12;break}if(s.id!=t.owner.id){e.next=5;break}return B(!0),Q(!1),e.abrupt("return",!0);case 5:return B(!1),n=(0,c.IO)((0,c.hJ)(ye,"sales"),(0,c.ar)("content","==",(0,c.JU)(ye,"content",Je)),(0,c.ar)("buyer","==",(0,c.JU)(ye,"users",s.id)),(0,c.b9)(1)),e.next=9,(0,c.PL)(n);case 9:return a=e.sent,Q(a.docs.length>0),e.abrupt("return",a.docs.length>0);case 12:case"end":return e.stop()}}),e)}))),Ie=b(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q||H){e.next=5;break}return e.next=3,(0,c.ET)((0,c.hJ)(ye,"sales"),{buyer:(0,c.JU)(ye,"users",s.id),content:(0,c.JU)(ye,"content",Je),datetime:c.EK.now()});case 3:e.sent,Q(!0);case 5:case"end":return e.stop()}}),e)}))),De=b(r().mark((function e(){var t,n,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.IO)((0,c.hJ)(ye,"content"),(0,c.ar)("copyOf","==",(0,c.JU)(ye,"content",Je)),(0,c.ar)("owner","==",(0,c.JU)(ye,"users",s.id))),e.next=3,(0,c.PL)(t);case 3:n=e.sent,a=n.docs.map((function(e){return{id:e.id,data:e.data()}})),X(a);case 6:case"end":return e.stop()}}),e)}))),Pe=b(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w.copyOf){e.next=5;break}return e.next=3,(0,c.QT)(w.copyOf);case 3:t=e.sent,z(t.data());case 5:case"end":return e.stop()}}),e)}))),Re=b(r().mark((function e(t){var n,s,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,c.JU)(ye,"users",t.owner.id),e.next=3,(0,c.QT)(n);case 3:s=e.sent,a=s.data(),y(a);case 6:case"end":return e.stop()}}),e)}))),_e=b(r().mark((function e(t){var n,s,a,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.tags.map((function(e){return e.id})),s=(0,c.IO)((0,c.hJ)(ye,"tags"),(0,c.ar)((0,c.Jm)(),"in",n)),e.next=4,(0,c.PL)(s);case 4:a=e.sent,i=a.docs.map((function(e){return{id:e.id,data:e.data()}})),V(i);case 7:case"end":return e.stop()}}),e)}))),Te=b(r().mark((function e(){var t,n,s,a,i,o,l,d;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.JU)(ye,"content",Je),n=(0,c.IO)((0,c.hJ)(ye,"reviews"),(0,c.ar)("content","==",t)),e.next=4,(0,c.PL)(n);case 4:if(s=e.sent,a=s.docs.map((function(e){return{id:e.id,data:e.data()}})),!((i=a.map((function(e){return e.data.user.id}))).length>0)){e.next=17;break}return o=(0,c.IO)((0,c.hJ)(ye,"users"),(0,c.ar)((0,c.Jm)(),"in",i)),e.next=11,(0,c.PL)(o);case 11:l=e.sent,d=l.docs.map((function(e){return{id:e.id,data:e.data()}})),S(d),C(a),e.next=18;break;case 17:S([]),C([]);case 18:case"end":return e.stop()}}),e)}))),Ve=b(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s&&Object.keys(s).length>0&&H)){e.next=6;break}return t=(0,c.IO)((0,c.hJ)(ye,"reviews"),(0,c.ar)("content","==",(0,c.JU)(ye,"content",Je)),(0,c.ar)("user","==",(0,c.JU)(ye,"users",s.id))),e.next=4,(0,c.PL)(t);case 4:(n=e.sent).docs.length>0?(de({id:n.docs[0].id,data:n.docs[0].data()}),ie(!0)):(ie(!1),de({}));case 6:case"end":return e.stop()}}),e)}))),Me=b(r().mark((function e(){var t,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.JU)(ye,"content",Je),n=(0,c.IO)((0,c.hJ)(ye,"sales"),(0,c.ar)("content","==",t)),e.next=4,(0,c.PL)(n);case 4:s=e.sent,R(s.docs.length);case 6:case"end":return e.stop()}}),e)}))),Ze=b(r().mark((function e(){var t,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.JU)(ye,"content",Je),n=(0,c.IO)((0,c.hJ)(ye,"content"),(0,c.ar)("copyOf","==",t)),e.next=4,(0,c.PL)(n);case 4:s=e.sent,I(s.docs.length);case 6:case"end":return e.stop()}}),e)}))),ze=b(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Je){e.next=6;break}return t=(0,c.JU)(ye,"content",Je),e.next=4,(0,c.QT)(t);case 4:(n=e.sent).exists()?j(n.data()):ke.push("/404","/not-found");case 6:case"end":return e.stop()}}),e)})));return(0,i.useEffect)((function(){ze()}),[Je]),(0,i.useEffect)((function(){w&&0!=Object.keys(w).length&&(Re(w),_e(w),Te(),Me(),Ze(),Pe())}),[w]),(0,i.useEffect)((function(){(n||X([]),w&&s&&0!=Object.keys(w).length&&0!=Object.keys(s).length)&&(Le(w)&&De());Ve()}),[w,n,s]),(0,i.useEffect)((function(){Ve()}),[s,H]),(0,i.useEffect)((function(){m.Z.getInstance().logEvent("Viewed Page: Content Details",{"Content ID":Je})}),[]),(0,i.useLayoutEffect)((function(){return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[fe.current]),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5",children:[(0,a.jsxs)("div",{className:"w-full col-span-1 md:col-span-2 lg:col-span-3 xl:col-span-4",children:[(0,a.jsxs)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-8",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("span",{className:"text-2xl flex items-center",children:[w.name," ",(0,a.jsx)(x.Z,{content:w})]}),n&&q&&(0,a.jsxs)("button",{className:"border border-gray-400 mx-2 p-2 hover:bg-gray-400 hover:text-white rounded",onClick:function(){$(!0)},children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 inline-block",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})," ","Edit"]})]}),G&&(0,a.jsx)("div",{children:(0,a.jsxs)("form",{onSubmit:Oe,children:[(0,a.jsx)("label",{children:"New Name"}),(0,a.jsx)("input",{type:"text",ref:se,className:"input-base form-input",name:"updatedName",defaultValue:w.name}),(0,a.jsxs)("button",{className:"btn-primary",type:"submit",onClick:Oe,children:[" ","Update Name"]}),(0,a.jsx)("button",{onClick:function(){$(!1)},children:"Cancel"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs",children:"Authored by"}),N?(0,a.jsxs)("div",{className:"text-gray-800",children:[(0,a.jsx)("span",{children:N.photoUrl?(0,a.jsx)("img",{src:N.photoUrl,className:"h-8 inline-block rounded-full"}):(0,a.jsx)("img",{src:"profile_pic.png",className:"h-8 inline-block rounded-full"})}),(0,a.jsx)("span",{className:"ml-1 text-base",children:N.name})]}):(0,a.jsx)("div",{})]}),(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)("div",{className:"my-2",children:T&&T.map((function(e){return(0,a.jsx)(l.default,{href:"/tag/[tagId]",as:"/tag/".concat(e.id),children:(0,a.jsx)("span",{style:{background:e.data.color,color:e.data.textColor},className:"rounded-3xl px-2 mx-1 text-xs cursor-pointer",children:e.data.name},e.id)},e.id)}))})})]}),(0,a.jsx)("div",{className:"row-end-auto bg-white shadow-md my-4 mx-2 rounded p-8",children:(0,a.jsxs)("div",{children:[n&&q&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"inline-block text-xl",children:"Description"}),(0,a.jsxs)("button",{className:"border border-gray-400 mx-2 p-2 hover:bg-gray-400 hover:text-white rounded",onClick:function(){ne(!0)},children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 inline-block",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})," ","Edit"]})]}),te&&(0,a.jsx)("div",{children:(0,a.jsxs)("form",{onSubmit:Ue,children:[(0,a.jsx)("label",{children:"New Description"}),(0,a.jsx)("textarea",{type:"text",ref:re,className:"input-base form-input",name:"updatedDescription",defaultValue:w.description}),(0,a.jsxs)("button",{className:"btn-primary",type:"submit",onClick:Ue,children:[" ","Update Description"]}),(0,a.jsx)("button",{onClick:function(){ne(!1)},children:"Cancel"})]})}),(0,a.jsx)("p",{className:"".concat(ge?"line-clamp-none":"line-clamp-5"," "),ref:fe,children:w.description}),be&&!ge&&(0,a.jsx)("p",{className:"font-bold text-dark-primary cursor-pointer",children:(0,a.jsx)("a",{onClick:function(){Ne(!0)},children:"Read more..."})})]})})]}),(0,a.jsxs)("div",{className:"col-span-1",children:[n&&q&&!w.copyOf&&!w.public&&(0,a.jsxs)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-8 text-center",children:[(0,a.jsxs)("div",{className:"text-sm mb-2",children:["Listing content will make it publicly available to others for free! Listing content publicly will allow others to copy it and use it on the Peerbots app."," "]}),(0,a.jsx)("div",{className:"text-sm font-bold mb-2",children:"Once content is public it can not be made private."}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("button",{className:"btn-primary",onClick:Se,children:"List this publicly for free!"})})]}),w.public&&!w.copyOf&&(0,a.jsxs)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-8 text-center",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-sm mb-2",children:"This content is available for"}),0==w.price?(0,a.jsx)("span",{className:"uppercase text-2xl text-green-700 font-bold",children:"Free"}):(0,a.jsx)("span",{className:"text-2xl text-accent-two font-bold",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(w.price)})]}),n?(0,a.jsx)(a.Fragment,{children:!(q||H)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{className:"btn-primary mt-4",onClick:function(){m.Z.getInstance().logEvent("Clicked Button: Content Details - Acquire Content",{"Content ID":Je}),Ie()},children:"+ Acquire"})," "]})}):(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("span",{className:"text-sm",children:"You must sign in to acquire content."}),(0,a.jsx)("button",{className:"btn-primary",disabled:!0,children:"+ Acquire"})]}),(0,a.jsxs)("div",{className:"text-center my-2 mt-8",children:[(0,a.jsxs)("span",{className:"mr-2",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 inline-block mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),P," sales"," "]}),(0,a.jsxs)("span",{children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 inline-block mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"})}),L," copies"]})]}),(0,a.jsx)("div",{className:"text-center",children:!w.copyOf&&w.public&&J&&(0,a.jsx)(u.Z,{reviews:J})})]}),w.copyOf&&(0,a.jsx)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-8",children:(0,a.jsxs)("div",{className:"text-center",children:["This is a copy of",(0,a.jsx)("div",{children:(0,a.jsx)(l.default,{href:"/content/[contentId]",as:"/content/".concat(w.copyOf.id),children:(0,a.jsx)("a",{className:"underline decoration-primary text-primary hover:text-dark-primary hover:decoration-dark-primary font-bold",children:Z.name})})})]})}),n&&(q||H)&&(0,a.jsx)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-8 text-center",children:(0,a.jsxs)("form",{onSubmit:Ee,children:[(0,a.jsx)("label",{className:"block mb-2",children:"Copy As"}),(0,a.jsx)("input",{type:"text",ref:he,className:"input-base form-input w-full text-gray-700",name:"copyAs",defaultValue:"Copy of ".concat(w.name)}),(0,a.jsx)("button",{className:"btn-primary mt-4",type:"submit",onClick:Ee,children:"Copy to App!"})]})})]})]}),w.public&&!w.copyOf&&J.length>0&&(0,a.jsx)("div",{className:"bg-white shadow-md my-4 mx-2 rounded p-8",children:(0,a.jsxs)("div",{className:"mb-6",children:[n&&H&&(0,a.jsxs)("div",{className:"bg-white rounded my-4",children:[ce?(0,a.jsx)("span",{className:"font-bold",children:"Update your review"}):(0,a.jsx)("span",{className:"font-bold",children:"Write a review"}),(0,a.jsxs)("form",{onSubmit:Ce,children:[(0,a.jsxs)("div",{children:["New Rating:",(0,a.jsx)(d.Z,{max:5,onChange:function(e,t){me(t)},className:"p-4"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Review:"}),ce?(0,a.jsx)("input",{type:"input",className:"input-base",ref:pe,placeholder:"Review Details",defaultValue:le.data.description}):(0,a.jsx)("input",{type:"input",className:"input-base",ref:pe,placeholder:"Review Details"}),(0,a.jsx)("button",{className:"btn-primary",type:"submit",children:"Submit Review"})]})]})]}),(0,a.jsx)("h3",{className:"text-xl",children:"Reviews"}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-2 md:gap-4 lg:gap-6",children:J.map((function(e){return(0,a.jsxs)("div",{className:"bg-white shadow-lg rounded p-4 w-64 mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsx)("div",{children:(0,a.jsx)(d.Z,{value:e.data.rating,max:5,readOnly:!0,size:"small"})}),(0,a.jsxs)("div",{className:"align-middle",children:[(0,a.jsx)("span",{children:(0,a.jsx)("img",{src:U.filter((function(t){return t.id==e.data.user.id}))[0].data.photoUrl,className:"rounded-full h-6 w-6 inline-block mr-1"})}),(0,a.jsx)("span",{className:"text-sm",children:U.filter((function(t){return t.id==e.data.user.id}))[0].data.name})]})]}),(0,a.jsx)("div",{className:"text-sm text-gray-700",children:e.data.description})]},e.id)}))})]})}),(0,a.jsx)("div",{children:K.length>0?(0,a.jsx)("div",{children:(0,a.jsx)(o.Z,{content:K,children:(0,a.jsx)("h3",{className:"text-xl",children:"Your copies"})})}):(0,a.jsx)("div",{children:""})})]})}}},function(e){e.O(0,[92,132,774,888,179],(function(){return t=6606,e(e.s=t);var t}));var t=e.O();_N_E=t}]);