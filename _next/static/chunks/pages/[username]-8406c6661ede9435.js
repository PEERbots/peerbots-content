(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[280],{5080:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[username]",function(){return t(1227)}])},1227:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return f}});var r=t(5666),s=t.n(r),a=t(5893),i=t(5321),c=t(7294),u=t(1132),o=t(4603),l=t(4467),d=t(6688),h=t(1163);function x(e,n,t,r,s,a,i){try{var c=e[a](i),u=c.value}catch(o){return void t(o)}c.done?n(u):Promise.resolve(u).then(r,s)}function m(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var a=e.apply(n,t);function i(e){x(a,r,s,i,c,"next",e)}function c(e){x(a,r,s,i,c,"throw",e)}i(void 0)}))}}function f(){var e=(0,h.useRouter)(),n=e.query.username,t=(0,c.useState)(null),r=t[0],x=t[1],f=(0,c.useState)({}),p=f[0],v=f[1],b=(0,c.useState)([]),w=b[0],j=b[1],k=(0,i.ad)(l.Z),N=(0,d.h)(),g=N.user,y=N.userInDb,C=(0,c.useState)(!1),E=C[0],_=C[1],S=(0,c.useState)(!1),U=S[0],P=S[1],D=(0,c.useState)(!1),J=D[0],V=D[1],z=(0,c.useState)(!1),I=z[0],L=z[1],M=(0,c.useRef)(),O=(0,c.useRef)(),R=(0,c.useRef)(),T=(0,c.useState)(""),B=T[0],Z=T[1],X=m(s().mark((function t(){var r,a,c,u,o,l;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=14;break}return r=(0,i.IO)((0,i.hJ)(k,"users"),(0,i.ar)("username","==",n)),t.next=4,(0,i.PL)(r);case 4:if(!((a=t.sent).docs.length>0)){t.next=9;break}c=a.docs[0].data(),v(c),x(a.docs[0].id),t.next=14;break;case 9:return u=(0,i.JU)(k,"users",n),t.next=12,(0,i.QT)(u);case 12:(o=t.sent).exists()?(l=o.data(),v(l),x(n)):e.push("/404","/not-found");case 14:case"end":return t.stop()}}),t)}))),q=m(s().mark((function e(){var n,t,a,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=8;break}return n=(0,i.JU)(k,"users",r),t=(0,i.IO)((0,i.hJ)(k,"content"),(0,i.ar)("owner","==",n),(0,i.ar)("public","==",!0)),e.next=5,(0,i.PL)(t);case 5:a=e.sent,c=a.docs.map((function(e){return{id:e.id,data:e.data()}})),j(c);case 8:case"end":return e.stop()}}),e)}))),F=m(s().mark((function e(n){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t=(0,i.JU)(k,"users",r),e.next=4,(0,i.r7)(t,{name:M.current.value});case 4:P(!1),X();case 6:case"end":return e.stop()}}),e)}))),Q=m(s().mark((function e(n){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t=(0,i.JU)(k,"users",r),e.next=4,(0,i.r7)(t,{description:O.current.value});case 4:V(!1),X();case 6:case"end":return e.stop()}}),e)}))),A=m(s().mark((function e(n){var t,a,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t=R.current.value,a=(0,i.IO)((0,i.hJ)(k,"users"),(0,i.ar)("username","==",t)),e.next=5,(0,i.PL)(a);case 5:if(!(e.sent.docs.length>0)){e.next=10;break}Z("Username is already taken. Try another one please."),e.next=16;break;case 10:return c=(0,i.JU)(k,"users",r),e.next=13,(0,i.r7)(c,{username:t});case 13:L(!1),Z(""),X();case 16:case"end":return e.stop()}}),e)})));return(0,c.useEffect)((function(){X(),o.Z.getInstance().logEvent("Viewed Page: Profile Details",{"Profile ID":n})}),[n]),(0,c.useEffect)((function(){q()}),[r]),(0,c.useEffect)((function(){y&&r&&Object.keys(y).length>0?_(y.id==r):_(!1)}),[y,r]),(0,a.jsx)("div",{children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white shadow-md my-4 mx-2 p-8 rounded",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("img",{src:p.photoUrl,className:"rounded-full h-12 w-12 inline-block mr-4"}),p.name,g&&E&&(0,a.jsxs)("button",{className:"border border-gray-400 m-2 p-2 hover:bg-gray-400 hover:text-white rounded",onClick:function(){P(!0)},children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 inline-block",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})," ","Edit name"]})]}),U&&(0,a.jsx)("div",{children:(0,a.jsxs)("form",{onSubmit:F,children:[(0,a.jsx)("label",{children:"New Name"}),(0,a.jsx)("input",{type:"text",ref:M,className:"input-base form-input",name:"updatedName",defaultValue:y.data.name}),(0,a.jsxs)("button",{className:"btn-primary",type:"submit",onClick:F,children:[" ","Update Name"]}),(0,a.jsx)("button",{onClick:function(){P(!1)},children:"Cancel"})]})}),(0,a.jsxs)("div",{children:[p.description&&(0,a.jsx)("span",{children:p.description}),g&&E&&(0,a.jsxs)("button",{className:"border border-gray-400 m-2 p-2 hover:bg-gray-400 hover:text-white rounded",onClick:function(){V(!0)},children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 inline-block",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})," ","Edit description"]})]}),J&&(0,a.jsx)("div",{children:(0,a.jsxs)("form",{onSubmit:Q,children:[(0,a.jsx)("label",{children:"New Description"}),(0,a.jsx)("textarea",{type:"text",ref:O,className:"input-base form-input",name:"updatedDescription",defaultValue:y.data.description}),(0,a.jsxs)("button",{className:"btn-primary",type:"submit",onClick:Q,children:[" ","Update Description"]}),(0,a.jsx)("button",{onClick:function(){V(!1)},children:"Cancel"})]})}),(0,a.jsxs)("div",{children:[g&&E&&p.username&&(0,a.jsxs)("span",{children:["Username: ",(0,a.jsx)("span",{children:p.username})]}),g&&E&&(0,a.jsxs)("button",{className:"border border-gray-400 m-2 p-2 hover:bg-gray-400 hover:text-white rounded",onClick:function(){L(!0)},children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 inline-block",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})," ","Edit username"]})]}),I&&(0,a.jsx)("div",{children:(0,a.jsxs)("form",{onSubmit:A,children:[(0,a.jsx)("label",{children:"New username"}),(0,a.jsx)("input",{type:"text",ref:R,className:"input-base form-input",name:"updatedusername",defaultValue:y.data.username}),(0,a.jsxs)("button",{className:"btn-primary",type:"submit",onClick:A,children:[" ","Update username"]}),(0,a.jsx)("button",{onClick:function(){L(!1)},children:"Cancel"}),(0,a.jsx)("span",{className:"text-secondary text-sm mx-4",children:B})]})})]}),(0,a.jsx)("div",{children:(0,a.jsx)("div",{children:(0,a.jsx)(u.Z,{content:w,children:(0,a.jsxs)("h3",{className:"text-xl",children:["Content authored by ",p.name]})})})})]}):{}})}}},function(e){e.O(0,[92,132,774,888,179],(function(){return n=5080,e(e.s=n);var n}));var n=e.O();_N_E=n}]);